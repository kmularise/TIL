# 확장성(규모 확장성)

## 수직적 규모 확장(scale up) VS 수평적 규모 확장(scale out)
* 스케일 업(scale up) : 기존 서버에 고사양 자원(CPU, RAM, 디스크)을 추가하는 방법
* 스케일 아웃(scale out) : 더 많은 서버를 추가하여 성능 향상

## 서버(웹 계층) 규모 확장
### 서버 - scale up
* 장점 : 서버로 유입되는 트래픽 양이 적을 때는 스케일 업이 좋은 선택이며, 이 방법의 가장 큰 장점은 단순함이다. 
* 사용상황 : 서버로 유입되는 트래픽 양이 적을 때
* 한계
    1. 한대의 서버에 CPU나 메모리를 무한대로 증설할 방법은 없다.
    2. 장애에 대한 failover(자동복구)나 redundancy(다중화) 방안을 제시하지 않는다. 서버에 장애가 발생하면 웹사이트/앱은 완전히 중단된다. 
### 서버 - scale out
* 대규모 애플리케이션을 지원하는 데에는 스케일 아웃이 적절하다.

## 데이터베이스 규모 확장
### 데이터베이스 - scale up
* 사용상황 : `ex) 스택오버플로는 2013년 한 해 동안 방문한 천만 명의 사용자 전부를 단 한대의 마스터 데이터베이스로 처리`
* 한계 :
    1. 데이터베이스 서버 하드웨어에는 한계가 있으므로 CPU, RAM 등을 무한 증설할 수 없다. 사용자가 계속 늘어나면 한 대 서버로는 결국 감당하기 어렵다.
    2. SPOF(Single Point of Failure)로 인한 위험성이 크다.
    3. 비용이 많이 든다.
### 데이터베이스 - scale out, sharding 
* 샤딩 : 대규모 데이터베이스를 샤드(shard)라고 부르는 작은 단위로 분할하는 기술
* 고려사항
    * 샤딩 키(파티션 키) 정하기 : 데이터를 고르게 분할할 수 있도록 하는 것이 중요
* 문제점
    * 시스템이 복잡해진다.
    * 데이터의 재 샤딩(resharding) : 데이터가 너무 많아지거나 데이터 분포가 균등하지 못한 경우
    * 유명인사(celebrity) 문제 : 특정 샤드에 질의가 집중되어 데이터베이스 서버에 과부하가 걸리는 문제
    * 조인과 비정규화(join and de-normalization) : 하나의 데이터베이스를 여러 샤드 서버로 쪼개고 나면, 여러 샤드에 걸친 데이터를 조인하기 힘들어진다. -> 데이터베이스를 비정규화하여 하나의 테이블에서 질의가 수행될 수 있도록 한다.


## 참고자료
* 가상 면접 사례로 배우는 대규모 시스템 설계

