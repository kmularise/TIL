# 의존관계 주입(DI)
* IoC라는 단어가 매우 느슨하게 정의되어 폭넓게 사용되는 용어이기 때문에 스프링을 IoC 컨테이너라고만 해서는 스프링이 제공하는 기능의 특징을 명확하게 설명하지 못한다.
* 그래서 의존관계 주입(Dependency Injection)이 스프링이 제공해주는 기능에 대한 의도가 더 명확히 드러난다.

## 의존 관계
![image](https://github.com/kmularise/TIL/assets/106499310/debbac65-cb18-46c4-b216-c703df10d923)
* A와 B 두 클래스가 의존 관계를 가지고 있다.
* A가 B에 의존하고 있다.
    * 의존한다는 것은 방향성이 있는데 A에는 변경이 있어도 B에 영향을 미치지 않지만, B에 변경이 있다면 A에 영향을 미친다.

## 의존관계 검색
* IoC 방법에는 의존관계 검색이라는 방법도 있다. 외부로부터 주입을 받는 것이 아니라 스스로 검색을 이용하기 때문에 의존관계 검색(Dependency Lookup)이라고 불린다.
* 의존관계 검색은 런타임시 의존관계를 맺을 오브젝트를 결정하는 것과 오브젝트의 생성 작업은 IoC에 맡기지만, 가져올 때는 메소드나 생성자를 통한 주입 대신 스스로 컨테이너에게 요청하는 방법을 사용한다.

## 의존관계 주입
* 클래스 모델이나 코드에서는 런타임 시점의 의존관계가 드러나지 않아야 한다. 즉, 인터페이스에만 의존해야 한다.
* 런타임 시점의 의존관계는 컨테이너나 팩토리(이전의 DaoFactory)와 같은 제3의 존재가 결정한다.
* 의존관계는 사용할 오브젝트에 대한 레퍼런스를 외부에서 제공(주입)해줌으로써 만들어진다.
> 스프링에서 말하는 제3의 존재는 애플리케이션 컨텍스트, 빈 팩토리, IoC 컨테이너 등으로 볼 수 있다.

## 의존관계 검색 vs 의존관계 주입
* 대부분은 의존관계 주입 방식을 사용하는 편이 좋다.
* 애플리케이션의 기동 시점에서 적어도 한 번은 의존관계 검색 방식을 사용해 오브젝트를 가져와야 한다. 스태틱 메소드인 main()에서는 DI를 이용해 오브젝트를 주입받을 방법이 없기 때문이다.
```java
public class UserDao {
    ConnectionMaker connectionMaker;

    // DL (Dependency Lookup) 를 이용한 방법
    public UserDao() {
        ApplicationContext applicationContext
                = new AnnotationConfigApplicationContext(DaoFactory.class);

        this.connectionMaker = applicationContext.getBean(ConnectionMaker.class);
    }
}
```
## 메소드를 통한 의존 관계 주입
* 생성자를 통한 의존관계 주입
    * 생성자 호출시점에 딱 1번만 호출되는 것이 보장된다. → 이후 값을 변경 못 하게 막을 수 있다.
    * 불변, 필수 의존관계에 사용
        * 불변: 생성자를 통해서만 의존관계가 주입되고, 이후 외부에서 수정할 수 없다.
        * 필수: 무조건 값이 있어야 한다.
* 수정자를 통한 의존관계 주입
    * 선택, 변경 가능성이 있는 의존관계에 사용 (final 필드 X)
        * 선택: 스프링 빈으로 등록되지 않은 인스턴스도 주입 가능, required = false로 주입할 대상이 없어도 동작하게 할 수 있다.
    * 변경: 변경 가능성 있는 의존관계 사용시 중간에 setter를 호출해 의존관계를 변경 가능
* 일반 메소드를 통한 의존관계 주입
    * 한번에 여러 필드를 주입 받을 수 있다.
    * 일반적으로 잘 사용하지 않는다.