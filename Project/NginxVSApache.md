## Nginx VS Apache
* Nginx : 대용량 트래픽을 처리하기 위해 가벼움과 높은 성능을 목표로 하는 경량 웹 서버
* Apache : 

## 1. 설계 아키텍처의 차이
* Nginx
    * 이벤트 중심 접근 방식으로 하나의 스레드 내에서 여러 요청을 처리하는 구조
    * 비동기 Event-Driven 구조 : Event Handler에서 비동기 방식으로 먼저 처리되는 요청을 진행 
    * 코어 모듈이 Apache보다 적은 리소스로도 많은 트래픽을 효율적으로 처리 가능
![image](https://github.com/kmularise/C_plus_plus_subjects/assets/106499310/6a1cfb7e-5fe9-4fd8-898c-01d4363d7fa9)

* Apache
    * 프로세스 기반 접근 방식으로 하나의 스레드가 하나의 요청을 처리하는 구조
    * 매 요청마다 스레드를 생성 및 할당해야 하기 때문에 리소스를 많이 잡아먹음
![image](https://github.com/kmularise/C_plus_plus_subjects/assets/106499310/67eefb67-ef73-4848-a707-eef5df106699)

## 2. 성능 차이 - 정적 컨텐츠, 동적 컨텐츠
### 정적 컨텐츠
Nginx는 Apache보다 정적 컨텐츠 처리가 빠르다.
* Nginx
    * 정적 콘텐츠를 처리할 때 NGINX는 요청될 때마다 사용할 수 있도록 정적 파일을 캐시
    -> Nginx는 Apache보다 정적 컨텐츠 처리가 빠르다.
* Apache
    * Apache는 파일 기반 접근 방식을 사용하여 정적 콘텐츠를 제공
### 동적 컨텐츠
동적 컨텐츠는 두 웹서버 성능이 비슷한다.
*  NGINX
    * Nginx 에는 동적 콘텐츠 처리 기능이 내장되어 있지 않다. 동적 콘텐츠를 처리하려면 요청을 FastCGI Process Manager(PHP-FPM) 와 같은 외부 프로세서로 전달해야 한다.
* Apache
    * 외부 구성 요소에 의존하지 않고 내부적으로 동적 콘텐츠를 처리할 수 있다.
## 추가 구성
* Apache
    * .htaccess 파일을 통해 디렉토리 별로 추가 구성을 허용
    * 이로 인해 권한이 없는 사용자가 웹 사이트의 특정 측면을 제어할 수 있다. 이로 인해 보안 상 문제를 발생시킬 수 있다.
    * Apache는 모든 문서 요청에 대해 각 .htaccess 파일을 로드하므로 사이트 성능에 영향을 미칠 수 있다. 트래픽이 많고 웹 페이지가 복잡한 사이트의 경우 많은 리소스를 소비한다.
* Nginx
    * 추가 구성을 허용하지 않음. 이로 인해 유연성이 제한되지만 사이트 성능을 높이는 데 도움이 된다. 
    * NGINX는 효율적으로 설계되었으므로 .htaccess 파일을 검색하고 해석할 필요가 없으므로 Apache보다 더 빠르게 요청을 처리할 수 있다.
    * NGINX는 루트 권한이 있는 사용자만 서버 및 사이트 설정을 변경할 수 있으므로 추가 구성을 허용하지 않아 서버 보안을 유지한다.
## 요청을 처리 및 해석하는 방법의 차이
* Nginx
    * 요청을 해석하기 위해 URI를 전달
    * URI로 전달함으로써 웹 서버뿐만 아니라 프록시 서버, 로드 밸런서 및 HTTP 캐시로 쉽게 동작 가능
    * 서버에서 클라이언트로 데이터가 전송되는 속도가 Apache보다 더 빠름
* Apache
    * 요청을 해석하기 위해 파일 시스템 위치 전달
    * URI 위치를 사용하지만 일반적으로 더 추상적인 디렉토리 구조를 사용

## 기능 모듈의 차이
* Nginx
    * 타사 플러그인 과정으로 선택되고 컴파일되기 때문에 동적으로 모듈을 로드할 수 없음
    * 따라서 사용하려는 기능만 선택해서 서버를 실행 = 가벼움
* Apache
    * 동적으로 로드 가능한 다양한 60개의 공식 모듈을 제공
    * 모든 모듈을 가지고 서버가 실행되지만 실제 사용되는 모듈을 소수임 = 무거움

## 보안
* Apache
    * 웹 서버를 안전하게 유지하기 위해 Apache는 DoS 공격을 방지하는 데 도움이 되는 구성 설정을 구현한다.
        * TimeOut – 요청이 실패하기 전에 Apache가 특정 이벤트를 기다리는 시간(초)을 정의한다. DoS 공격을 받기 쉬운 웹사이트에서는 이 숫자가 몇 초 정도로 낮아야 한다.
        * RequestReadTimeout – 요청을 충분히 빨리 보내지 않는 클라이언트의 연결을 종료한다.
        * KeepAliveTimeout – Apache 서버가 새 요청에 대해 연결을 대기하고 유지하는 시간을 결정한다.
    * Apache는 안전하고 안정적으로 구축되었지만 서버 보안은 구성 방법에 따라 달라진다. 웹 애플리케이션 방화벽(WAF) 설치와 같은 추가 보안 조치를 구현해야 한다.
* Nginx
    * NGINX 사용자는 클라이언트의 IP 주소를 기반으로 액세스를 허용하거나 거부하여 DDoS 공격을 예방할 수 있다.
    * 비밀번호 또는 대역폭을 사용하여 엑세스를 제한할 수도 있다.
    * 안정적인 데이터 전송 암호화를 제공하는 최신 TLS(SSL, 전송 계층 보안) 버전을 지원한다.

## 웹서버 선택 기준
* Apache 서버의 장점은 주로 유연성에 있다.
    * 이는 기본 구성 파일을 수정할 수 있는 루트 액세스를 제공하므로 권한이 없는 사용자가 여러 서버 설정을 제어할 수 있다. 그러나 서버 메모리를 많이 소모할 수 있다.
* Nginx 서버의 장점에는 높은 정적 콘텐츠 요청 처리 성능, 동시에 많은 클라이언트에 서비스 제공 및 리소스 효율성이 있다. 웹 페이지가 복잡하고 트래픽 양이 많을 때 Nginx가 적합하다.
* Nginx는 기능이 많다. 사용자는 웹 서버, 리버스 프록시, 로드 밸런서 또는 캐싱 솔루션으로 사용할 수 있다. 
## 참고자료
* https://w3techs.com/technologies/history_overview/web_server/ms
* https://kinsta.com/blog/nginx-vs-apache/
* https://www.hostinger.com/tutorials/nginx-vs-apache-what-to-use/#:~:text=What%20Are%20the%20Main%20Differences,and%20high%2Dperformance%20than%20Apache.
* https://serverguy.com/comparison/apache-vs-nginx/
